; Yakuza Kiwami 2 VWF Patch
;
; Yakuza Kiwami 2 has the VWF table inside the exe.
; The table has 256 positions, so it is enough to contain the width of all the ISO-8859-1 characters in yakuza.dds
; The table is accesed using the character value.
; The problem is that the game uses UTF-8 encoding for the strings, so the equivalence are:
; [00 - 7F] => Standard ASCII values. (Are equal in UTF-8 and ISO-8859-1)
; [C280 - C2BF] => ISO-8859-1 values between 80 and BF
; [C380 - C3BF] => ISO-8859-1 values between C0 and FF
;
; This patch adds 2 small functions that gets the index for the ISO-8859-1 character, so the exe can use the VWF table.
;
>yakuzakiwami2.exe
00000000001DF933:81->E8 ; Check (cmp esi, 0x100) replaced with function call
00000000001DF934:FE->FB
00000000001DF935:00->75
00000000001DF936:01->E6
00000000001DF937:00->01
00000000001DF938:00->90
00000000001DF939:73->90
00000000001DF93A:16->90
00000000001DF957:3D->E8 ; Check (cmp eax, 0x100) replaced with function call
00000000001DF958:00->16
00000000001DF959:01->76
00000000001DF95A:00->E6
00000000001DF95B:00->01
00000000001DF95C:73->90
00000000001DF95D:15->90
00000000001E63F9:81->E8 ; Check (cmp esi, 0x100) replaced with function call
00000000001E63FA:FE->35
00000000001E63FB:00->0B
00000000001E63FC:01->E6
00000000001E63FD:00->01
00000000001E63FE:00->90
00000000001E63FF:73->90
00000000001E6400:16->90
00000000001E641D:3D->E8 ; Check (cmp eax, 0x100) replaced with function call
00000000001E641E:00->50
00000000001E641F:01->0B
00000000001E6420:00->E6
00000000001E6421:00->01
00000000001E6422:73->90
00000000001E6423:15->90
0000000002046F33:00->81 ; Start of the first function (ESI)
0000000002046F34:00->FE
0000000002046F35:00->80
0000000002046F39:00->73
0000000002046F3A:00->01
0000000002046F3B:00->C3
0000000002046F3C:00->81
0000000002046F3D:00->FE
0000000002046F3E:00->80
0000000002046F3F:00->C2
0000000002046F42:00->73
0000000002046F43:00->06
0000000002046F44:00->BE
0000000002046F49:00->C3
0000000002046F4A:00->81
0000000002046F4B:00->FE
0000000002046F4C:00->C0
0000000002046F4D:00->C2
0000000002046F50:00->73
0000000002046F51:00->07
0000000002046F52:00->81
0000000002046F53:00->EE
0000000002046F55:00->C2
0000000002046F58:00->C3
0000000002046F59:00->81
0000000002046F5A:00->FE
0000000002046F5B:00->80
0000000002046F5C:00->C3
0000000002046F5F:00->73
0000000002046F60:00->02
0000000002046F61:00->EB
0000000002046F62:00->E1
0000000002046F63:00->81
0000000002046F64:00->FE
0000000002046F65:00->C0
0000000002046F66:00->C3
0000000002046F69:00->73
0000000002046F6A:00->D9
0000000002046F6B:00->81
0000000002046F6C:00->EE
0000000002046F6D:00->C0
0000000002046F6E:00->C2
0000000002046F71:00->C3
0000000002046F72:00->3D ; Start of the second function (EAX)
0000000002046F73:00->80
0000000002046F77:00->73
0000000002046F78:00->01
0000000002046F79:00->C3
0000000002046F7A:00->3D
0000000002046F7B:00->80
0000000002046F7C:00->C2
0000000002046F7F:00->73
0000000002046F80:00->06
0000000002046F81:00->B8
0000000002046F86:00->C3
0000000002046F87:00->3D
0000000002046F88:00->C0
0000000002046F89:00->C2
0000000002046F8C:00->73
0000000002046F8D:00->06
0000000002046F8E:00->2D
0000000002046F90:00->C2
0000000002046F93:00->C3
0000000002046F94:00->3D
0000000002046F95:00->80
0000000002046F96:00->C3
0000000002046F99:00->73
0000000002046F9A:00->02
0000000002046F9B:00->EB
0000000002046F9C:00->E4
0000000002046F9D:00->3D
0000000002046F9E:00->C0
0000000002046F9F:00->C3
0000000002046FA2:00->73
0000000002046FA3:00->DD
0000000002046FA4:00->2D
0000000002046FA5:00->C0
0000000002046FA6:00->C2
0000000002046FA9:00->C3